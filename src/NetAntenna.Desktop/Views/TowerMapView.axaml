<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:NetAntenna.Desktop.ViewModels"
             xmlns:mapsui="clr-namespace:Mapsui.UI.Avalonia;assembly=Mapsui.UI.Avalonia"
             x:Class="NetAntenna.Desktop.Views.TowerMapView"
             x:DataType="vm:TowerMapViewModel">

    <Grid RowDefinitions="Auto,*">
        <!-- Control Header -->
        <!-- Control Header -->
        <Border Grid.Row="0" Background="#1E1E2E" CornerRadius="8" Padding="16" Margin="0,0,0,12">
            <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,Auto">
                
                <!-- Row 0: Title and Status -->
                <WrapPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,12">
                    <TextBlock Text="FCC Tower Map" FontSize="20" FontWeight="SemiBold" Foreground="White" Margin="0,0,16,0" VerticalAlignment="Center"/>
                    
                    <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center" Margin="0,0,16,0">
                        <TextBlock Text="Towers Indexed:" Foreground="#B0B0B0" />
                        <TextBlock Text="{Binding TowerCount}" Foreground="White" FontWeight="Bold" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center" Margin="0,0,16,0">
                        <TextBlock Text="Last Updated:" Foreground="#B0B0B0" />
                        <TextBlock Text="{Binding LastUpdateText}" Foreground="White" />
                    </StackPanel>
                </WrapPanel>

                <!-- Row 0: Download Button -->
                <Button Grid.Row="0" Grid.Column="1" 
                        Content="â¬‡ï¸ Download FCC Data" 
                        Command="{Binding DownloadFccDataCommand}" 
                        IsEnabled="{Binding !IsUpdating}"
                        Padding="16,8"
                        Background="#313244"
                        VerticalAlignment="Top">
                    <Button.Styles>
                        <Style Selector="Button:disabled">
                            <Setter Property="Content" Value="â³ Downloading (takes ~30s)..." />
                        </Style>
                    </Button.Styles>
                </Button>

                <!-- Row 1: Location Controls -->
                <WrapPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center" Margin="0,0,16,8">
                        <TextBox Text="{Binding SearchAddress}" Watermark="Enter your address..." Width="250" Padding="6,2" FontSize="12" />
                        <Button Content="ðŸ” Find" Command="{Binding SearchAddressCommand}" IsEnabled="{Binding !IsSearchingAddress}" Padding="12,6" FontSize="12" Background="#313244" Foreground="White" CornerRadius="4"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center" Margin="0,0,0,8">
                        <TextBlock Text="Lat:" Foreground="#B0B0B0" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding UserLat}" Width="80" Padding="6,2" FontSize="12" />
                        <TextBlock Text="Lng:" Foreground="#B0B0B0" VerticalAlignment="Center" Margin="4,0,0,0"/>
                        <TextBox Text="{Binding UserLng}" Width="80" Padding="6,2" FontSize="12" />
                        <Button Content="ðŸ’¾ Save" Command="{Binding SaveLocationCommand}" Padding="12,6" FontSize="12" Background="#00BCD4" Foreground="White" CornerRadius="4" Margin="4,0,0,0"/>
                    </StackPanel>
                </WrapPanel>

            </Grid>
        </Border>

        <!-- Map Container -->
        <Border Grid.Row="1" Background="#11111B" CornerRadius="8" ClipToBounds="True">
            <mapsui:MapControl x:Name="TowerMap" />
        </Border>
    </Grid>
</UserControl>
